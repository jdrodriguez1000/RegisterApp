# Implementation Plan: User Registration App (Detailed Phases)

This plan organizes the development into "Major Events" or deliverables to ensure a structured approach to building the application.

## User Review Required

> [!IMPORTANT]
> **Mobile-Only Design**: The app will be locked to ~390x844px.
> **Mandatory Flow**: Users cannot skip the email verification or the profile completion steps.

---

## Phase 1: Foundation & Core Logic [COMPLETED ✅]
Setup the backend and the essential micro-framework configuration. (Finalized 2026-01-19)

### [Component] Database & Security
#### [NEW] `schema.sql`
- Create `profiles` table and enable RLS.
#### [MODIFY] [core/database.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/core/database.py)
- Establish connection to Supabase.

### [Component] App Configuration
#### [MODIFY] [main.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/main.py)
- Setup fixed window dimensions and Fleting initialization.
#### [NEW] [configs/languages/](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/configs/languages/)
- Initial `es.json` and `en.json` files.

---

## Phase 2: Major Event - Onboarding Experience [COMPLETED ✅]
The first interaction the user has with the app. (Finalized 2026-01-19)

### [Component] Onboarding UI
#### [NEW] [views/pages/welcome_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/welcome_view.py)
- **Deliverable**: A premium welcome screen with "Get Started" button.

---

## Phase 3: Major Event - Authentication & Access (Login) [COMPLETED ✅]
The secure entry point and main navigation hub.

### [Component] Auth Management
#### [MODIFY] [views/pages/welcome_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/welcome_view.py)
- Change "Get Started" button destination to `/login`.
#### [NEW] [views/pages/login_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/login_view.py)
- **Deliverable**: Secure login interface with Email and Password fields.
- Include a link "Don't have an account? Join us" pointing to `/register`.
- [NEW] Temporary "Under Construction" view for placeholder links.
- **Temporary Redirect**: The "Login" button will point to `/construction` until the Registration (Phase 4) is finished to avoid confusing testers.

---

## Phase 4: Major Event - User Registration & Verification [COMPLETED ✅]
Ensuring only verified users can access the system.

### [Component] Registration Flow
#### [NEW] [views/pages/register_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/register_view.py)
- Fields for Email, Password, and Full Name.
- Include a link "Already have an account? Login" pointing to `/login`.
#### [NEW] [views/pages/email_verification_pending_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/email_verification_pending_view.py)
- **Deliverable**: A screen blocking users until their email is confirmed.

---

## Phase 5: Major Event - Mandatory Profile Completion [COMPLETED ✅]
Capturing specific user details required for the application.

### [Component] Profile Engine
#### [MODIFY] [core/router.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/core/router.py)
- Logic to reroute users to `profile_completion_view` if data is missing.
#### [NEW] [views/pages/profile_completion_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/profile_completion_view.py)
- **Deliverable**: Forms for Gender, Birth Date, Civil Status, Favorite Color, and Sport.

---

## Phase 6: Major Event - User Dashboard [COMPLETED ✅]
The main workspace for the authenticated user. (Finalized 2026-01-19)

### [Component] Dashboard UI
#### [NEW] [views/pages/dashboard_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/dashboard_view.py)
- **Deliverable**: Display of all profile information in a premium UI.
- [NEW] Bottom Navigation Bar with 3 items:
  1. Language (Icon: Globe/Language) -> Redirects to `/construction` for now.
  2. Password (Icon: Lock) -> Redirects to `/construction` for now.
  3. Edit Profile (Icon: Edit/User) -> Redirects to `/construction` for now.

---

## Phase 7: Major Event - Secure Password Change [COMPLETED ✅]
Allowing users to update their credentials from within the app. (Finalized 2026-01-19)

### [Component] Password Internal Management
#### [NEW] [models/change_password_model.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/models/change_password_model.py)
- Logic for validating current password and new password strength.
#### [NEW] [controllers/change_password_controller.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/controllers/change_password_controller.py)
- Integration with Supabase auth for re-authentication and password update.
#### [NEW] [views/pages/change_password_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/change_password_view.py)
- **Deliverable**: UI with Current Password, New Password, and Confirm New Password fields.
- Visual feedback for password strength.
- Integration with the controller to handle the update process.
#### [MODIFY] [core/router.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/core/router.py)
- Register the `/change-password` route.
#### [MODIFY] [views/pages/dashboard_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/dashboard_view.py)
- Link the "Password" icon in the navigation bar to `/change-password`.

---

## Phase 8: Major Event - Edit Profile [COMPLETED ✅]
Allowing users to modify their personal information. (Finalized 2026-01-19)

### [Component] Profile Management
#### [NEW] [views/pages/edit_profile_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/edit_profile_view.py)
- **Deliverable**: Form pre-filled with existing data (Gender, Birth Date, Etc).
  Redesigned with professional aesthetic using Stack background, cards with shadows, and user identification (Name/Email) for consistency with the application's style guide.
- Logic to update the `profiles` table in Supabase.

---

## Phase 9: Major Event - Language Settings [COMPLETED ✅]
Allowing users to personalize the application language and managing dynamic lists through internationalization.

### [Component] Internationalization
#### [UPDATE] [core/i18n.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/core/i18n.py)
- Support for fetching lists (arrays) from translation files.
- Support for local persistent storage of language preference.

#### [NEW] [configs/languages/pt.json](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/configs/languages/pt.json)
- **Deliverable**: Complete Portuguese translation file.

#### [UPDATE] [en.json, es.json, pt.json]
- Move static lists (Genders, Civil Statuses, Colors, Sports) to JSON for central management.

#### [NEW] [views/pages/language_settings_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/language_settings_view.py)
- **Deliverable**: Professional language selector (EN/ES/PT).
- Updates the application language globally and persists user preference.

---

## Phase 10: Major Event - Technical Debt Consolidation
Refining the codebase for scalability, maintainability, and architectural consistency.

### [Component] UI & Architecture
#### [NEW] `views/components/`
- **Deliverable**: Create a library of shared components (e.g., `CustomSnackbar`, `LoadingOverlay`, `StyledButton`) to eliminate duplication in View files.
#### [MODIFY] `core/state.py`
- **Deliverable**: Enhance the Global State manager to cache user profile and session data, minimizing redundant remote API calls.
#### [NEW] `configs/theme.py`
- **Deliverable**: Extract all hardcoded colors, shadows, and typography styles into a centralized design system configuration.

### [Component] Data & UX
#### [MODIFY] `core/error_handler.py` & `configs/languages/`
- **Deliverable**: Implement a mapping system that translates technical server errors (Supabase/Auth) into user-friendly localized messages.
#### [DATA] Database Normalization
- **Deliverable**: Ensure all "list" data (Gender, Color, etc.) is stored as indices/keys in the database, and run a cleanup if necessary to remove literal strings.
#### [MODIFY] `core/router.py`
- **Deliverable**: Secure the navigation stack to handle edge cases in "back" actions and ensure mandatory flows cannot be bypassed via hardware back buttons.

---

## Phase 11: Major Event - Password Recovery (External)
Helping users regain access when they forget their password.

### [Component] Recovery Flow
#### [NEW] [views/pages/forgot_password_view.py](file:///c:/Users/USUARIO/Documents/Proyectos/RegisterApp/views/pages/forgot_password_view.py)
- **Deliverable**: Flow for password recovery emails and reset interface.

---

## Phase 12: Major Event - Final Application Testing
End-to-end validation of the complete system.

### [Component] Testing & QA
#### [Manual Verification]
- **Deliverable**: Detailed report/log of all functional tests.
- E2E flow: Welcome -> Login -> Register -> Verify Email -> Login -> Complete Profile -> Dashboard.
- Edge cases: Invalid passwords, duplicate emails, unauthorized access attempts.
- Security check: Verify RLS policies are active in Supabase.

---

## Verification Plan

### Manual Verification (Per Phase Deliverable)
1. **Phase 1-6**: Cumulative verification of standard flows.
2. **Phase 7**: Verify successful password change and rejection of incorrect "current password".
3. **Phase 8**: Verify profile updates reflect in Dashboard and Database.
4. **Phase 9**: Verify language switch changes UI text immediately and persists on reload.
5. **Phase 10**: Verify that UI remains consistent after refactoring and database calls are reduced.
6. **Phase 11**: Verify recovery email is received and the link allows setting a new password.
7. **Phase 12**: Final E2E test suite.
